---
id: xim2x
name: Auth guard
file_version: 1.0.2
app_version: 0.9.7-2
file_blobs:
  libs/core/nest-lib/src/lib/auth.guard.ts: 616beffbddb78bd24d03d0288cd9d3ad9f89ffdf
---

This component uses `getUserDataFromSessionId`[<sup id="Zz56KF">â†“</sup>](#f-Zz56KF) [Redis functions](redis-functions.tk1hl.sw.md)

<br/>

The Auth guard ignores the external `calendars/callback`, `login`[<sup id="Z2bik08">â†“</sup>](#f-Z2bik08) and `registration` routes
<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### ðŸ“„ libs/core/nest-lib/src/lib/auth.guard.ts
```typescript
â¬œ 1      import { CanActivate, ExecutionContext, Injectable } from '@nestjs/common';
â¬œ 2      import { getUserDataFromSessionId } from '@syncit2.0/core/utils';
â¬œ 3      
ðŸŸ© 4      const unProtectedRoutes = [
ðŸŸ© 5        '/api/auth/login',
ðŸŸ© 6        '/api/auth/register',
ðŸŸ© 7        '/api/calendars/callback/:calId',
ðŸŸ© 8      ];
â¬œ 9      
â¬œ 10     @Injectable()
â¬œ 11     export class AuthGuard implements CanActivate {
```

<br/>

If the path should be ignored return `true`[<sup id="2v9QFc">â†“</sup>](#f-2v9QFc) and exit without other checks
<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### ðŸ“„ libs/core/nest-lib/src/lib/auth.guard.ts
```typescript
â¬œ 11     export class AuthGuard implements CanActivate {
â¬œ 12       async canActivate(context: ExecutionContext): Promise<boolean> {
â¬œ 13         const request = context.switchToHttp().getRequest();
ðŸŸ© 14         if (unProtectedRoutes.includes(request.route.path)) {
ðŸŸ© 15           return true;
ðŸŸ© 16         }
â¬œ 17         const userData = await getUserDataFromSessionId(request.cookies.sessionID);
â¬œ 18         return userData?.id;
â¬œ 19       }
```

<br/>

The auth guard is trying get `userData`[<sup id="Z2ey1NQ">â†“</sup>](#f-Z2ey1NQ) from sessionId generated from the cookie sent



<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### ðŸ“„ libs/core/nest-lib/src/lib/auth.guard.ts
```typescript
â¬œ 14         if (unProtectedRoutes.includes(request.route.path)) {
â¬œ 15           return true;
â¬œ 16         }
ðŸŸ© 17         const userData = await getUserDataFromSessionId(request.cookies.sessionID);
ðŸŸ© 18         return userData?.id;
â¬œ 19       }
â¬œ 20     }
â¬œ 21     
```

<br/>

<!-- THIS IS AN AUTOGENERATED SECTION. DO NOT EDIT THIS SECTION DIRECTLY -->
### Swimm Note

<span id="f-Zz56KF">getUserDataFromSessionId</span>[^](#Zz56KF) - "libs/core/nest-lib/src/lib/auth.guard.ts" L2
```typescript
import { getUserDataFromSessionId } from '@syncit2.0/core/utils';
```

<span id="f-Z2bik08">login</span>[^](#Z2bik08) - "libs/core/nest-lib/src/lib/auth.guard.ts" L5
```typescript
  '/api/auth/login',
```

<span id="f-2v9QFc">true</span>[^](#2v9QFc) - "libs/core/nest-lib/src/lib/auth.guard.ts" L15
```typescript
      return true;
```

<span id="f-Z2ey1NQ">userData</span>[^](#Z2ey1NQ) - "libs/core/nest-lib/src/lib/auth.guard.ts" L17
```typescript
    const userData = await getUserDataFromSessionId(request.cookies.sessionID);
```

<br/>

This file was generated by Swimm. [Click here to view it in the app](https://app.swimm.io/repos/Z2l0aHViJTNBJTNBc3luY2l0JTNBJTNBdGlrYWxr/docs/xim2x).